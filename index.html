<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>陈老师问前程</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>陈老师问前程</h1>
        </header>
        
        <main>
            <!-- API配置区域 -->
            <div class="api-config-section" id="apiConfigSection">
                <div class="api-key-row">
                    <label>🔑 API Key：</label>
                    <input type="password" id="apiKeyInput" placeholder="输入 Gemini API Key" />
                    <button class="btn-small" onclick="saveApiKey()">保存</button>
                    <span id="keyStatus"><span style="color:orange;">未配置</span></span>
                </div>
                <div class="api-key-row">
                    <button id="testApiBtn" class="btn-test" onclick="testGeminiAPI()">🔗 测试连接</button>
                    <span id="apiTestResult"></span>
                </div>
                <p class="api-hint">💡 <a href="https://aistudio.google.com/app/apikey" target="_blank">点击获取免费 Gemini API Key</a></p>
            </div>

            <!-- 解卦历史记录 -->
            <div class="history-section" id="historySection">
                <div class="history-header" onclick="toggleHistory()">
                    <span>📜 解卦记录</span>
                    <span class="history-toggle" id="historyToggle">▼</span>
                </div>
                <div class="history-list" id="historyList" style="display:none;"></div>
            </div>

            <!-- 问题选择区域 -->
            <div class="question-section" id="questionSection">
                <label for="questionSelect">请选择您要询问的问题：</label>
                <select id="questionSelect">
                    <option value="">请选择问题...</option>
                    <option value="1">入职新公司是否有利</option>
                    <option value="2">跟人合作是否有利</option>
                    <option value="3">投资新生意是否有利</option>
                    <option value="4">交新的女朋友是否合得来</option>
                    <option value="5">父亲生病了，这个病能好吗？</option>
                    <option value="6">去北方旅游是否顺利</option>
                </select>
                <button id="startBtn" class="btn-primary" disabled>开始算卦</button>
            </div>

            <!-- 起卦过程区域 -->
            <div class="divination-section" id="divinationSection" style="display: none;">
                <div class="progress-info">
                    <p>第 <span id="currentStep">1</span> 次抛掷（共6次）</p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>

                <div class="coin-throw-area">
                    <h3>抛掷三枚铜钱</h3>
                    <div class="coins-display" id="coinsDisplay">
                        <div class="coin coin-1"></div>
                        <div class="coin coin-2"></div>
                        <div class="coin coin-3"></div>
                    </div>
                    <button id="throwBtn" class="btn-primary">抛掷铜钱</button>
                </div>

                <div class="result-display" id="resultDisplay" style="display: none;">
                    <div class="throw-result" id="throwResult"></div>
                    <div class="yao-symbol" id="yaoSymbol"></div>
                </div>

                <div class="yao-history" id="yaoHistory"></div>
            </div>

            <!-- 卦象展示区域 -->
            <div class="gua-display-section" id="guaDisplaySection" style="display: none;">
                <h2>卦象结果</h2>
                
                <div class="question-info">
                    <p><strong>您的问题：</strong><span id="selectedQuestion"></span></p>
                </div>

                <div class="gua-container">
                    <div class="gua-box">
                        <h3>初始卦</h3>
                        <div class="gua-diagram" id="initialGua"></div>
                        <div class="gua-name" id="initialGuaName"></div>
                        <div class="gua-info" id="initialGuaInfo"></div>
                        <div class="gua-details" id="initialGuaDetails"></div>
                    </div>

                    <div class="gua-box">
                        <h3>新卦（变卦）</h3>
                        <div class="gua-diagram" id="newGua"></div>
                        <div class="gua-name" id="newGuaName"></div>
                        <div class="gua-info" id="newGuaInfo"></div>
                        <div class="gua-details" id="newGuaDetails"></div>
                    </div>
                </div>

                <div class="ai-prompt-section">
                    <h3>AI解卦提示</h3>
                    <div class="ai-prompt-box" id="aiPromptBox"></div>
                    <div class="ai-btn-group">
                        <button id="copyPromptBtn" class="btn-copy">复制提示词</button>
                        <button id="askGeminiBtn" class="btn-ai">AI解卦</button>
                    </div>
                    <div class="ai-response-section" id="aiResponseSection" style="display:none;">
                        <h4>🔮 AI解卦结果</h4>
                        <div class="ai-response-box" id="aiResponseBox"></div>
                    </div>
                </div>

                <button id="resetBtn" class="btn-reset">重新算卦</button>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>

